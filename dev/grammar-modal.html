<!-- [规范] 1. 样式部分 -->
<style>
    /* 这里的样式只在组件内部生效 */
    :host { display: none; } /* 默认隐藏宿主 */
    :host(.active) { display: block; } /* 宿主激活时显示 */

    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex; justify-content: center; align-items: center;
        z-index: 10000;
    }

    /* ... 其他 CSS 代码保持不变 ... */
    .modal-content { background: white; padding: 25px; border-radius: 8px; width: 500px; }
    .modal-tab.active { color: #3498db; border-bottom: 2px solid #3498db; }
    .modal-tab-content { display: none; }
    .modal-tab-content.active { display: block; }
</style>

<!-- [规范] 2. 结构部分 (必须用 template 包裹) -->
<template>
    <div class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header"><h3 class="modal-title">语法点</h3></div>
            <div class="modal-body">
                <div class="modal-tabs">
                    <button class="modal-tab active" data-tab="form">当前语法数据</button>
                    <button class="modal-tab" data-tab="json">添加语法数据</button>
                </div>
                <!-- Tab 内容 1 -->
                <div class="modal-tab-content active" data-tab="form">
                    <div class="form-group">
                        <label>当前语法数据</label>
                        <textarea class="json-input" id="grammar-rule-now"></textarea>
                    </div>
                </div>
                <!-- Tab 内容 2 -->
                <div class="modal-tab-content" data-tab="json">
                    <div class="form-group">
                        <label>JSON数据</label>
                        <textarea class="json-input" id="grammar-json"></textarea>
                        <div class="add-method-buttons">
                            <button class="btn batch-add-btn">批量添加JSON</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancel-btn">取消</button>
                </div>
            </div>
        </div>
    </div>
</template>

<!-- [规范] 3. 逻辑部分 -->
<script>
    // [约定] 使用 $root 来查找元素，不要用 document
    // [约定] 使用 $host 来控制显隐或对外交互

    const closeBtn = $root.querySelector('#cancel-btn');
    const tabs = $root.querySelectorAll('.modal-tab');
    
    // 关闭逻辑
    closeBtn.addEventListener('click', () => {
        $host.classList.remove('active'); // 操作宿主类名
    });

    // Tab 切换逻辑
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const target = tab.dataset.tab;
            // 清除 active
            $root.querySelectorAll('.modal-tab').forEach(t => t.classList.remove('active'));
            $root.querySelectorAll('.modal-tab-content').forEach(c => c.classList.remove('active'));
            // 激活当前
            tab.classList.add('active');
            $root.querySelector(`.modal-tab-content[data-tab="${target}"]`).classList.add('active');
        });
    });

    // [API导出] 如果你想让外部调用组件的方法，可以直接挂载到 $host 上
    $host.open = () => {
        $host.classList.add('active');
    };
    
    $host.getValue = () => {
        return $root.querySelector('#grammar-json').value;
    }
</script>
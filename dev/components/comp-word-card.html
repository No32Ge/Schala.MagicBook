<style>
    .card { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); border-left: 5px solid #4f46e5; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    h2 { margin: 0; font-size: 1.5rem; color: #111827; }
    .actions { opacity: 0; transition: 0.2s; }
    .card:hover .actions { opacity: 1; }
    .sub-cards-area { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
</style>

<div class="card">
    <div class="header">
        <h2 s-text="word"></h2>
        <div class="actions">
            <button class="btn btn-outline" style="font-size:0.8em" s-on="click:handleEdit">编辑</button>
            <button class="btn btn-danger" style="font-size:0.8em" s-on="click:handleDelete">×</button>
        </div>
    </div>

    <!-- 这里是存放子卡片（翻译、例句、备注）的容器 -->
    <div id="dynamic-slots" class="sub-cards-area"></div>
</div>

<script>
    // 注册所有可能的子卡片模板
    $loader.registerComponent('comp-card-trans', './components/comp-card-trans.html');
    $loader.registerComponent('comp-card-sentence', './components/comp-card-sentence.html');
    $loader.registerComponent('comp-card-note', './components/comp-card-note.html');

    let currentData = {};

    // 监听传入的数据
    $watch('card-data', (val) => {
        if (!val) return;
        currentData = JSON.parse(val);
        $state.word = currentData.word;
        renderSubCards(currentData);
    });

    // 动态渲染子模板策略
    function renderSubCards(data) {
        const container = $scope.querySelector('#dynamic-slots');
        container.innerHTML = '';

        // 策略模式：定义字段与组件的映射
        const strategies = [
            { key: 'trans', tag: 'comp-card-trans' },
            { key: 'sentence', tag: 'comp-card-sentence' },
            { key: 'note', tag: 'comp-card-note' }
        ];

        strategies.forEach(strat => {
            if (data[strat.key] && data[strat.key].trim() !== '') {
                const el = document.createElement(strat.tag);
                // 传递内容
                el.setAttribute('content', data[strat.key]);
                container.appendChild(el);
            }
        });
    }

    $methods.handleEdit = () => $emit('edit', currentData.id);
    $methods.handleDelete = () => $emit('delete', currentData.id);
</script>